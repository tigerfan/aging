# 产品29：记忆采集与回忆触发家居节点（详细设计实现文档）

## 0. 文档信息
- 版本：v1.0
- 目标：构建家庭叙事资产，支持认知下降人群记忆触发
- 形态：相框、台灯、门边触点等家居节点

## 1. 建设目标
1. 让回忆触发从“主动翻相册”变为“情境自然触发”。
2. 支持家庭成员协同维护记忆内容。
3. 控制触发强度，避免情绪负担。

## 2. 范围边界
- **In Scope**：内容采集、触发规则、回放与协同编辑。
- **Out of Scope**：心理治疗替代、公开社交平台运营。

## 3. 功能需求
### Must
- FR-01：按时间/地点/人物触发回忆片段。
- FR-02：家庭成员共同编辑内容。
- FR-03：禁忌内容屏蔽与权限控制。

### Should
- FR-04：认知训练任务绑定。
- FR-05：内容备份与恢复。

### Could
- FR-06：家族口述史自动整理。

## 4. 非功能指标
- 触发准确率 > 85%。
- 内容加载延迟 < 1s。
- 家庭协作操作成功率 > 95%。

## 5. 总体架构
```text
家居触点设备(NFC/环境感知/音频)
   -> 记忆触发引擎
      -> 家庭内容App + 记忆云库
```

## 6. 硬件设计
- NFC触发模块：实体触点交互。
- 环境感知模块：时间/光照/位置触发辅助。
- 音频播放模块：短回忆片段播放。

## 7. 软件模块
1. `MemoryAssetManager`：内容采集与管理。
2. `TriggerRuleEngine`：情境触发规则执行。
3. `PlaybackOrchestrator`：回放编排与连续性控制。
4. `FamilyPermissionService`：细粒度权限管理。

## 8. 数据模型
- `MemoryAsset { id, type, people_tags, place_tags, time_tags }`
- `TriggerRule { condition_set, priority, cooldown }`
- `PlaybackSession { ts, asset_id, response }`
- `FamilyContribution { member_id, edit_type, ts }`

## 9. 算法策略
- 聚类逻辑：时间/地点/人物三轴聚类生成回忆线索。
- 触发节流：同类内容短时间不重复触发。
- 情绪保护：命中禁忌标签直接抑制播放。

## 10. 接口定义
- `POST /api/v1/memory/asset/upload`
- `POST /api/v1/memory/rule/update`
- `POST /api/v1/memory/playback/trigger`
- `POST /api/v1/memory/contribution/add`

## 11. 交互流程
1. 家庭成员上传照片与语音故事。
2. 设置触发规则与可见权限。
3. 日常情境中节点触发短回忆。
4. 家庭成员可即时补充故事内容。

## 12. 安全与合规
- 端到端加密与细粒度授权。
- 支持内容撤回、备份、恢复。
- 家庭成员权限冲突有审计记录。

## 13. 测试与验收
- 触发稳定性与误触抑制测试。
- 老人可理解性与情绪安全评估。
- 验收：家庭参与率与有效触发率达标。

## 14. 实施计划
- P1：单节点“回忆盒”版本。
- P2：多节点联动。
- P3：跨代协作内容生态。

## 15. 风险与缓解
- 风险：触发不当引发负面情绪。  
  缓解：禁忌标签 + 触发冷却 + 家属审核。
