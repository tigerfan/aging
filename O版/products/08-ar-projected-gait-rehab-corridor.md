# 产品08：AR地投步态康复走廊（详细设计实现文档）

## 0. 文档信息
- 版本：v1.0
- 使用场景：家庭走廊、康复驿站
- 目标：提升康复依从性并降低训练损伤风险

## 1. 建设目标
1. 提供可视化步点训练与节奏引导。
2. 实时纠偏，减少错误动作重复。
3. 形成远程康复处方闭环。

## 2. 范围边界
- **In Scope**：步态训练、姿态纠偏、训练报告。
- **Out of Scope**：医疗诊断、复杂全身康复替代。

## 3. 功能需求
### Must
- FR-01：投影步点与节奏提示。
- FR-02：动作姿态实时纠偏。
- FR-03：训练结果评分与报告。

### Should
- FR-04：康复师远程调参。
- FR-05：周报趋势分析。

### Could
- FR-06：双人挑战模式提升趣味性。

## 4. 非功能指标
- 端到端反馈延迟 < 80ms。
- 骨架追踪帧率 >= 30fps。
- 训练任务完成率提升 > 35%。

## 5. 总体架构
```text
短焦投影 + RGBD相机
   -> 边缘AI主机(骨架估计+步态分析)
      -> 训练引擎(处方执行)
         -> 康复师云端平台
```

## 6. 硬件设计
- 短焦投影仪：2m空间可完成核心训练。
- RGBD相机：姿态与深度同步采样。
- 防滑地贴：定义安全训练区域。

## 7. 软件模块
1. `PoseEstimator`：骨架关键点提取。
2. `GaitPhaseAnalyzer`：步态相位识别。
3. `ProjectionEngine`：步点渲染与纠偏提示。
4. `TrainingPlanner`：处方编排与进阶。
5. `ReportService`：训练结果与趋势输出。

## 8. 数据模型
- `PoseFrame { ts, joints[], confidence }`
- `GaitPhase { phase, duration, symmetry_score }`
- `TrainingSession { task_id, completion, errors }`

## 9. 算法设计
- 骨架估计 + 时序平滑避免抖动。
- 步态相位检测输出摆动/支撑周期偏差。
- 错误动作分级：轻微（提示）/严重（暂停）。

## 10. 接口定义
- `POST /api/v1/rehab/prescription/apply`
- `GET /api/v1/rehab/session/report`
- `POST /api/v1/rehab/therapist/comment`

## 11. 交互流程
1. 用户选择训练任务。
2. 地面投影步点，用户按节奏完成。
3. 系统实时语音/视觉纠偏。
4. 训练结束输出总结与下次目标。

异常流程：
- 用户偏离安全区或姿态失稳时自动暂停并提示休息。

## 12. 安全与合规
- 本地骨架化处理，不存原始人像视频。
- 防眩目、低亮度夜间模式。
- 明确训练建议不替代医生面诊。

## 13. 测试与验收
- 低照度与逆光条件识别测试。
- 姿态纠偏准确性对照康复师评估。
- 家庭小空间（2m模式）可用性验证。

验收标准：
- 纠偏有效率 >= 85%。
- 用户训练依从性提升 > 35%。

## 14. 实施计划
- 阶段1：下肢平衡训练上线。
- 阶段2：障碍跨越与节奏训练。
- 阶段3：认知双任务训练融合。

## 15. 风险与缓解
- 风险：空间不足影响体验。  
  缓解：2m最小模式与缩放处方。
- 风险：长期训练新鲜感下降。  
  缓解：任务关卡化与成就激励。
