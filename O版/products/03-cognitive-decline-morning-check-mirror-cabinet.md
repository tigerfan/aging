# 产品03：认知衰退晨检镜柜（详细设计实现文档）

## 0. 文档信息
- 文档版本：v1.0
- 目标：将晨间高重复行为转化为认知风险的数字生物标志物
- 适用对象：轻度认知障碍高风险、独居高龄老人

## 1. 建设目标与边界
### 1.1 目标
1. 在不增加负担的情况下持续追踪晨间流程质量。
2. 发现“慢变化”异常并生成可解释趋势报告。
3. 为家属与医生提供早期干预信号。

### 1.2 边界
- **In Scope**：晨检流程监测、趋势分析、异常提醒、周报输出。
- **Out of Scope**：确诊结论、医疗治疗方案推荐。

## 2. 关键场景
- 06:30~09:00洗漱、取药、穿戴辅助器具。
- 漏服药、错序执行、重复动作增加。
- 节假日/外出导致行为节律变化。

## 3. 功能需求
### Must
- FR-01：识别晨间步骤序列。
- FR-02：检测漏步骤、错序、停滞、重复。
- FR-03：输出趋势级风险报告并推送家属。

### Should
- FR-04：异常片段复核与标签修正。
- FR-05：医生门户查看长期趋势。

### Could
- FR-06：嵌入短时认知训练任务。

## 4. 非功能指标
- 日常监测无感化（用户新增操作<=1步）。
- 异常检测AUC >= 0.85。
- 周报生成时延 < 30s。
- 离线可用，断网7天可缓存。

## 5. 总体架构
```text
镜柜传感阵列(ToF/霍尔/重量/声学)
    -> 端侧序列建模引擎
        -> 云端数字孪生档案与医生门户
            -> 家属App周报/异常提醒
```

## 6. 硬件设计
- ToF深度：动作区域覆盖镜前1.5m。
- 霍尔开关：柜门开闭精确采样。
- 重量传感：药盒与物品取放监测。
- 环境麦克风：只提取非语义声学特征。

## 7. 软件模块
1. `RoutineSegmenter`：晨间会话切分。
2. `StepRecognizer`：步骤识别与时序标注。
3. `SequenceAnomalyDetector`：异常检测。
4. `TrendEngine`：周/月趋势评分。
5. `FamilyDoctorPortal`：双端报表展示。

## 8. 数据模型
- `RoutineStepEvent { step_id, start_ts, duration, confidence }`
- `AnomalyEvent { type, severity, context_tags }`
- `CognitiveTrendReport { week, score, delta, explainers }`

存储策略：
- 原始传感流仅本地短期缓存。
- 云端保存统计特征、趋势与解释因子。

## 9. 算法策略
### 9.1 建模方案
- 基线模型：HMM（可解释）。
- 增强模型：LSTM（处理长时依赖）。
- 融合策略：置信加权投票。

### 9.2 异常规则
- 连续3天漏步骤率上升 -> 周报升档。
- 错序 + 停滞联发 -> 触发家属复核。
- 事件标签（旅行/访客）参与阈值校准。

## 10. 接口定义
- `GET /api/v1/cognitive/weekly-report?user_id=&week=`
- `POST /api/v1/cognitive/event-label`
- `GET /api/v1/cognitive/anomaly-timeline`

## 11. 交互与告警
正常流程：
1. 用户晨间使用镜柜。
2. 系统被动记录步骤。
3. 镜面仅在必要时提示“今日遗漏步骤”。
4. 每周生成一次家属与医生双版本报告。

异常流程：
- 连续高风险周：建议联系记忆门诊评估（提示型，不诊断）。

## 12. 安全合规
- 不上传原始音视频。
- 全链路加密与访问审计。
- 文案统一采用“风险趋势”表达。
- 满足知情同意和撤回授权机制。

## 13. 测试与验收
- 步骤识别准确率 >= 92%。
- 异常事件漏检率 < 8%。
- 家属报告可读性满意度 >= 85%。

## 14. 实施计划
- 阶段1：家庭MVP（20户，12周）。
- 阶段2：社区筛查项目（100户，24周）。
- 阶段3：与记忆门诊系统联动。

## 15. 风险与缓解
- 风险：生活习惯变化被误判。  
  缓解：引入事件标签与个体基线动态更新。
- 风险：用户对“被监测”敏感。  
  缓解：本地处理可视化说明 + 随时关闭。
