# 产品09：疼痛识别体位自调床垫（详细设计实现文档）

## 0. 文档信息
- 版本：v1.0
- 面向人群：慢性腰背痛、骨关节炎老人
- 目标：夜间自动支撑调节，减少疼痛导致的睡眠中断

## 1. 建设目标
1. 识别夜间疼痛相关体压与微运动模式。
2. 自动调节分区支撑，减少频繁夜醒。
3. 提供可解释睡眠与体位报告。

## 2. 范围边界
- **In Scope**：体压监测、自动调节、告警、报告。
- **Out of Scope**：医疗治疗替代、药物建议。

## 3. 功能需求
### Must
- FR-01：体压热图实时监测。
- FR-02：分区气囊自动调节。
- FR-03：异常持续时提醒人工干预。

### Should
- FR-04：用户偏好记忆。
- FR-05：午休轻模式。

### Could
- FR-06：与理疗设备联动。

## 4. 非功能指标
- 执行噪声 < 30dB。
- 调节响应 < 2s。
- 断电回中性位成功率 100%。

## 5. 总体架构
```text
压敏阵列 + 微运动采样
   -> 疼痛推断引擎
      -> 分区气囊执行层
         -> 睡眠报告服务
```

## 6. 硬件设计
- 压敏阵列：分区采样体压分布。
- 气囊执行层：支持分区独立调压。
- 阀控与微气泵：低噪高精度调节。
- UPS模块：断电保护与回位执行。

## 7. 软件模块
1. `PressureCollector`：采样与热图生成。
2. `DiscomfortInferencer`：不适区推断。
3. `PostureController`：支撑调节策略执行。
4. `SafetyGuard`：防夹与异常回位。
5. `SleepReportEngine`：夜间报告输出。

## 8. 数据模型
- `PressureMapSummary { zone_values[], peak_points }`
- `DiscomfortEvent { zone, level, duration }`
- `AdjustmentAction { zone, delta_kpa, result }`

## 9. 算法策略
- 多特征融合：体压异常 + 微运动频次 + 夜醒关联。
- 调节策略：渐进式调压（2kPa/s上限）避免惊扰。
- 终止条件：两轮调节无改善则发起人工确认。

## 10. 接口定义
- `GET /api/v1/bed/night-summary`
- `POST /api/v1/bed/preference/update`
- `POST /api/v1/bed/manual-override`

## 11. 交互流程
1. 入睡后自动进入监测模式。
2. 检测不适区触发分区调节。
3. 无改善时提醒用户或家属干预。
4. 次晨输出体位与睡眠摘要。

## 12. 安全与合规
- 故障自动回中性位。
- 机械防夹与温升保护。
- 报告仅用于健康管理，不作诊断。

## 13. 测试与验收
- 噪声测试、耐久测试、断电恢复测试。
- 场景测试：翻身频繁、双人床扰动。
- 指标：夜醒次数下降 > 20%，满意度 > 85%。

## 14. 实施计划
- Phase1：单人床MVP。
- Phase2：偏好学习与午休模式。
- Phase3：双人独立分区版本。

## 15. 风险与缓解
- 风险：误调节造成打扰。  
  缓解：渐进调节 + 用户确认阈值。
- 风险：气囊老化引发性能退化。  
  缓解：寿命预测与主动维保。
