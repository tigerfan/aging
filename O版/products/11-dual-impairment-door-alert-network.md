# 产品11：听视双障碍门禁告警网络（详细设计实现文档）

## 0. 文档信息
- 版本：v1.0
- 目标对象：听力下降且视力减退的高龄用户
- 目标：保证关键家庭告警“可感知、可确认、可追踪”

## 1. 建设目标
1. 将门铃/烟雾/燃气等事件统一接入告警总线。
2. 将单通道告警升级为多模态告警（光、振、屏）。
3. 实现关键事件高到达率与低漏告警。

## 2. 范围边界
- **In Scope**：告警接入、优先级分层、多终端同步、确认闭环。
- **Out of Scope**：公共安防平台替代、视频监控取证系统。

## 3. 功能需求
### Must
- FR-01：事件统一接入与分类。
- FR-02：多模态告警映射（灯带、震动、电子墨水屏）。
- FR-03：关键告警循环提醒直到确认。

### Should
- FR-04：访客身份识别与远程确认。
- FR-05：夜间静默策略（仅保留紧急事件）。

### Could
- FR-06：字幕电话与门禁联动。

## 4. 非功能指标
- 关键告警到达率 >= 99.9%。
- 告警触达时延 < 2s。
- 设备离线自动重连成功率 >= 99%。

## 5. 总体架构
```text
门口节点/烟感/燃气报警器
   -> 家庭网关事件总线
      -> 灯带终端 + 振动终端 + 电子墨水屏
         -> 家属App与告警审计服务
```

## 6. 硬件设计
- 门口节点：门铃输入、可选摄像头（边缘处理）。
- 振动终端：手环或床头震动器。
- 灯带终端：高亮但可控频闪。
- 电子墨水屏：静态文本低功耗持续提示。

## 7. 软件模块
1. `EventIngestor`：多源告警接入。
2. `PriorityEngine`：P0/P1/P2优先级分层。
3. `ModalityMapper`：事件到提醒通道映射。
4. `AckManager`：确认与升级流程。
5. `DeviceHeartbeat`：离线检测与重连。

## 8. 数据模型
- `AlertEvent { id, type, priority, ts }`
- `DeliveryStatus { terminal_id, delivered, retry_count }`
- `AckAction { actor, ts, channel }`
- `EscalationRecord { level, reason, target }`

## 9. 规则策略
- P0（烟雾/燃气）：全终端高强度 + 强确认。
- P1（门铃/访客）：双通道提醒。
- P2（普通消息）：单通道非打扰提醒。

## 10. 接口定义
- `POST /api/v1/alert/event`
- `POST /api/v1/alert/ack`
- `GET /api/v1/alert/history`
- `POST /api/v1/device/register`

## 11. 交互流程
1. 事件触发并分类。
2. 网关分发到对应终端。
3. 用户确认后关闭；未确认则升级。

异常流程：
- 主终端失联时，自动切换备用终端并通知家属。

## 12. 安全与合规
- 访客图像边缘处理，默认短期留存。
- 家属权限分级，避免过度共享家庭信息。
- 告警审计链路完整可追溯。

## 13. 测试与验收
- 高并发告警压力测试。
- 断电/断网恢复测试。
- 验收标准：关键告警漏达率 < 0.1%。

## 14. 实施计划
- 阶段1：门铃场景上线。
- 阶段2：燃气/烟雾接入。
- 阶段3：社区适老化改造批量部署。

## 15. 风险与缓解
- 风险：提醒过载造成疲劳。  
  缓解：优先级策略 + 夜间静默 + 事件合并。
