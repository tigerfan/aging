# 产品23：防滑鞋垫-地面协同防跌系统（详细设计实现文档）

## 0. 文档信息
- 版本：v1.0
- 目标：构建“人-鞋-地”动态协同防跌能力
- 适用场景：浴室、厨房、雨天门厅、机构走廊

## 1. 建设目标
1. 在“迈步前一秒”输出滑移风险提醒。
2. 建立家庭与机构高风险地面热力图。
3. 支持物业/机构巡检联动改造。

## 2. 范围边界
- **In Scope**：风险评分、实时提醒、热力图与工单。
- **Out of Scope**：全面姿态康复替代、视频监控。

## 3. 功能需求
### Must
- FR-01：步态稳定性实时检测。
- FR-02：地面摩擦等级识别（标签协同）。
- FR-03：高风险即时提醒（震动/语音）。

### Should
- FR-04：家庭高风险点热力图。
- FR-05：巡检工单自动生成。

### Could
- FR-06：机构防跌策略自学习。

## 4. 非功能指标
- 提醒延迟 < 500ms。
- 滑倒事件下降 > 30%。
- 鞋垫续航 >= 7天。

## 5. 总体架构
```text
智能鞋垫(压力/湿滑) + 地面标签(NFC/BLE)
   -> 风险引擎(边缘/手机)
      -> App热力图 + 巡检平台
```

## 6. 硬件设计
- 足底压力阵列：重心与步态稳定性估计。
- 湿滑传感：鞋底接触环境感知。
- 低功耗芯片：长续航运行。
- 地面标签：区域摩擦等级与维护状态标识。

## 7. 软件模块
1. `GaitStabilityAnalyzer`：稳定性评分。
2. `FrictionEstimator`：地面摩擦估计。
3. `SlipRiskEngine`：风险联合建模。
4. `AlertManager`：提醒节流与强度控制。
5. `HotspotMapService`：热区聚合与工单输出。

## 8. 数据模型
- `SlipRiskEvent { ts, zone_id, risk_score, triggered }`
- `FloorTagStatus { tag_id, friction_level, updated_at }`
- `HomeHotspotMap { zones[], heat_values[] }`
- `InspectionTicket { zone, priority, status }`

## 9. 算法策略
- 风险函数：`f(步态稳定性, 摩擦系数, 历史滑移事件)`。
- 阈值自适应：基于用户步态基线动态调整。
- 事件压缩：同一区域短时重复仅提示一次。

## 10. 接口定义
- `POST /api/v1/slip/risk/upload`
- `GET /api/v1/slip/hotspot-map`
- `POST /api/v1/slip/inspection/create`

## 11. 交互流程
1. 用户进入高风险区域。
2. 系统计算风险并发出“减速扶稳”提醒。
3. 事件累计形成热力图。
4. 达阈值自动生成改造工单。

## 12. 安全与合规
- 默认不采集视频与人脸信息。
- 位置信息按区域粒度保存。
- 用户可关闭地理关联记录。

## 13. 测试与验收
- 湿滑地面模拟测试。
- 不同鞋型兼容性测试。
- 验收：滑倒事件下降>30%，提醒疲劳投诉<5%。

## 14. 实施计划
- P1：机构浴室先行。
- P2：家庭场景扩展。
- P3：物业巡检联动平台。

## 15. 风险与缓解
- 风险：提醒过密引起忽略。  
  缓解：事件去重 + 个体阈值调优。
