# 产品15：骨关节炎楼梯助力扶手（详细设计实现文档）

## 0. 文档信息
- 版本：v1.0
- 目标对象：膝骨关节炎、下肢肌力下降老人
- 目标：降低楼梯场景跌倒与疼痛负担

## 1. 建设目标
1. 在楼梯场景提供主动助力而非被动支撑。
2. 根据步频与受力变化动态调整助力。
3. 保障机械失效下仍可安全被动使用。

## 2. 范围边界
- **In Scope**：助力输出、异常制动、设备维保。
- **Out of Scope**：电梯替代、康复治疗设备替代。

## 3. 功能需求
### Must
- FR-01：握持识别并自动进入助力模式。
- FR-02：上/下楼动态助力输出。
- FR-03：异常拖拽检测与限扭制动。

### Should
- FR-04：疲劳评分与休息建议。
- FR-05：物业维保工单自动生成。

### Could
- FR-06：楼道共享预约调度。

## 4. 非功能指标
- 助力响应时延 < 100ms。
- 机械失效安全可用率 100%。
- 设备可用性 >= 99%。

## 5. 总体架构
```text
助力扶手(力矩传感+驱动)
   -> 控制器(步态与助力算法)
      -> 楼层节点与物业平台
         -> 维保工单系统
```

## 6. 硬件设计
- 力矩传感器：检测握持受力变化。
- 电机助力模块：可控输出与软启动。
- 防夹结构：机械限位 + 软硬件双保护。
- 急停按钮：异常时一键停机。

## 7. 软件模块
1. `GripDetector`：握持状态识别。
2. `AssistController`：助力曲线实时计算。
3. `SafetyBrake`：异常制动策略。
4. `FatigueEstimator`：疲劳评分。
5. `MaintenanceService`：故障码与维保管理。

## 8. 数据模型
- `ClimbSession { direction, steps, duration }`
- `TorqueOutput { ts, value, mode }`
- `FatigueScore { score, confidence }`
- `FaultCode { code, severity, action }`

## 9. 控制策略
- 上楼：抬升阶段增加助力。
- 下楼：降低冲击并提供阻尼支持。
- 异常：受力突变/反向拖拽触发限扭停机。

## 10. 接口定义
- `GET /api/v1/stair/session/latest`
- `POST /api/v1/stair/assist/profile`
- `POST /api/v1/stair/fault/report`

## 11. 交互流程
1. 用户握持扶手进入助力态。
2. 系统按步频输出助力。
3. 到层后平滑退出。
4. 生成使用与疲劳摘要。

## 12. 安全与合规
- 机械失效后可被动通行。
- 温升、电流、扭矩三重保护。
- 仅记录匿名使用数据，不采集身份视频。

## 13. 测试与验收
- 负载测试、耐久测试、急停测试。
- 老人实地上下楼可用性测试。
- 验收：上下楼成功率>98%，零严重安全事故。

## 14. 实施计划
- P1：单栋老旧小区样板。
- P2：多楼层联动与调度。
- P3：片区化部署与维保中心。

## 15. 风险与缓解
- 风险：维护成本高。  
  缓解：模块化更换与远程诊断。
- 风险：用户学习成本。  
  缓解：一键启停 + 语音指引。
