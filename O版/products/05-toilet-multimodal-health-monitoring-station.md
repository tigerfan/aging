# 产品05：卫生间排泄健康多模态监测站（详细设计实现文档）

## 0. 文档信息
- 文档版本：v1.0
- 部署环境：家庭卫生间、养老机构卫浴区
- 目标：将如厕行为转化为连续健康趋势信号

## 1. 项目目标与边界
### 1.1 目标
1. 连续追踪排尿/排便相关风险指标。
2. 早期识别便秘、脱水、泌尿异常趋势。
3. 以低干扰方式输出可执行建议。

### 1.2 边界
- **In Scope**：趋势监测、风险分层、行为建议。
- **Out of Scope**：实验室诊断替代、疾病确诊。

## 2. 用户与场景
- 独居老人：无法稳定记录排泄变化。
- 照护者：希望减少主观观察误差。
- 医生：需要长期趋势用于随访判断。

## 3. 功能需求
### Must
- FR-01：排泄频次、颜色/浑浊度趋势监测。
- FR-02：异常趋势预警（脱水、便秘、泌尿风险）。
- FR-03：如厕后自动生成“风险等级 + 建议”。

### Should
- FR-04：饮水与膳食建议联动。
- FR-05：医生报告导出。

### Could
- FR-06：与慢病管理平台联动。

## 4. 非功能指标
- 自动分析完成时间 < 3s。
- 趋势预警准确率 > 85%。
- 防水等级 >= IP65。
- 维护可用率 > 98%。

## 5. 总体架构
```text
马桶附件传感器(光谱/流量/气味)
    -> 边缘分析盒
        -> 健康App/照护端
            -> 医生报告导出服务
```

## 6. 硬件设计
- 光谱模块：检测颜色、浑浊度等特征。
- 流量传感：估算排泄体积与时间分布。
- 气味传感：采集挥发性特征。
- 自清洁结构：冲洗后自动清洁采样面。

## 7. 软件模块
1. `EventDetector`：识别如厕事件起止。
2. `FeatureExtractor`：提取多模态特征。
3. `TrendAnalyzer`：个体基线 + 异常检测。
4. `RecommendationEngine`：行为建议生成。
5. `MaintenanceMonitor`：传感漂移与故障自检。

## 8. 数据模型
- `ExcretionEvent { ts, duration, feature_vector_id }`
- `HydrationScore { daily_score, confidence }`
- `ConstipationTrend { week_index, risk_level, explainers }`
- `UrologyRiskFlag { type, level, advice }`

## 9. 算法策略
### 9.1 基线建模
- 前14天建立个体基线。
- 后续采用滑动窗口检测偏移趋势。

### 9.2 异常识别
- 单次异常不直接强告警。
- 连续多日偏离 + 相关特征共振才升档。

### 9.3 建议策略
- 低风险：行为建议。
- 中风险：建议观察并补充记录。
- 高风险：建议就医并导出报告。

## 10. 接口设计
- `GET /api/v1/excretion/daily-summary`
- `GET /api/v1/excretion/trend?range=7d`
- `POST /api/v1/excretion/report/export`
- `POST /api/v1/device/calibration`

## 11. 交互流程
1. 用户正常如厕，无需额外动作。
2. 系统自动分析并推送简短结论。
3. 连续风险升高时提醒照护者关注。
4. 一键导出医生可读趋势报告。

异常流程：
- 传感器污染或校准失败时，暂停判读并推送维护提醒。

## 12. 隐私与合规
- 不采集正脸与身份视频。
- 原始敏感图像不上传、不长期存储。
- 云端仅保存匿名特征向量和趋势结果。

## 13. 测试与验收
- 实验室标样对照测试。
- 家庭真实环境稳定性测试（温湿、清洁剂干扰）。
- 维护流程测试（自清洁、漂移校准、故障恢复）。

验收门槛：
- 趋势误判率 < 10%。
- 自动清洁有效率 >= 95%。

## 14. 实施计划
- 阶段1：便秘/脱水两类风险MVP。
- 阶段2：扩展泌尿健康风险模型。
- 阶段3：机构版多终端集中管理。

## 15. 风险与缓解
- 风险：清洁不到位导致漂移。  
  缓解：自清洁 + 维护提醒 + 自动校准。
- 风险：用户对隐私敏感。  
  缓解：透明数据说明 + 本地优先处理。
