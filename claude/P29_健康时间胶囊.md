# P29 健康时间胶囊——纵向健康档案智能管理平台

---

## A. 需求分析文档

### 1. 产品概述与定位

**健康时间胶囊**是一款聚焦老年人全生命周期健康数据整合与智能分析的云端平台，将老人在本产品体系中各设备产生的数据（P13血糖/P14血压/P15心电/P17肾功能/P18骨密度/P26睡眠/P28问诊记录等）汇聚成一份完整的纵向健康档案，并通过AI对健康趋势进行深度分析，提前识别健康恶化风险，向老人、家属和医生提供可执行的健康管理建议。核心价值是让碎片化的健康数据产生"1+1>2"的协同洞察价值。

**蓝海点**：现有每种健康设备都有独立APP，数据孤岛严重；全科医生最缺乏的是患者长期纵向健康数据；AI驱动的健康趋势分析和跨指标关联分析（如血糖+血压+睡眠质量的联合分析）市场几乎空白。

### 2. 目标用户画像

| 维度 | 描述 |
|------|------|
| 核心用户 | 60–80岁，使用多种健康监测设备，希望统一管理健康数据的老年人 |
| 次要用户 | 有慢病患者的家庭，需要统一管理父母/祖父母多维健康数据 |
| 医疗用户 | 全科医生、老年科医生、家庭医生，需要患者完整健康档案支持决策 |
| 数据来源 | 本系列P13–P28各产品数据 + 医院HIS导入 + 手动录入 |

### 3. 市场痛点与机会

- 老年患者平均有4–6种慢病，对应4–6个专科医生，但没有人统筹全貌
- 每次就医前，患者无法快速提供完整的历史指标和趋势，医生诊断信息不充分
- 不同健康设备数据格式不一（HL7/FHIR/私有API），整合难度大
- 国家"互联互通"政策推进健康数据标准化，时机已成熟
- 家属管理多位老年家庭成员健康状态的需求被严重低估

### 4. 功能性需求（FR）

**FR-01 多源数据整合**
- 内部整合：本系列P13–P28设备数据自动同步（API直连）
- 外部整合：
  - 医院电子病历（通过健康码/医保卡对接各地健康信息平台）
  - 主流健康APP（微信运动步数、Apple Health等，标准API导入）
  - 手动录入：历史体检报告（OCR识别PDF/图片）、手术记录
- 数据归一化：统一时区、单位、命名规范（SNOMED CT医疗术语标准）

**FR-02 智能健康分析仪表盘**
- 时间轴视图：所有健康指标按时间排列，关键事件（住院/手术/用药调整）标注
- 指标组合视图：跨维度关联分析（如：血糖vs运动量，睡眠质量vs血压，体重vs血糖）
- AI健康摘要：每周自动生成100字健康周报（面向老人，通俗易懂）
- 趋势预警：某指标连续3周恶化趋势，自动触发提醒

**FR-03 AI健康洞察引擎**
- 跨指标关联分析：
  - "您睡眠质量差的周，血压平均高8mmHg，建议改善睡眠"
  - "运动量每增加30分钟，空腹血糖平均低0.4mmol/L"
- 健康年龄评估：基于多维指标，估算生理年龄（与实际年龄比对）
- 1年健康预测：基于当前趋势，预测关键指标1年后状态（激励干预）
- 风险评分：心血管风险评分（Framingham）、肾病进展风险、跌倒风险综合评分

**FR-04 就医辅助**
- 就医前报告生成：一键生成"就医摘要"（主要慢病状态、近期指标变化、用药清单）
- 科室推荐：根据异常指标，推荐就诊科室（"血肌酐连续升高，建议肾内科就诊"）
- 检查结果解读：OCR识别医院检验报告，AI通俗解读（"您的血肌酐110μmol/L，轻度偏高..."）
- 用药提示：多药联用，自动检测已知相互作用（结合P16用药管家数据）

**FR-05 家庭健康管理**
- 家庭账户：一个家庭账户管理多位老人（父母/祖父母）的健康档案
- 家属视角：子女可查看老人健康趋势，重要变化推送提醒
- 护理记录：子女/护工记录日常护理情况（用餐、排泄、情绪等），与客观指标关联
- 跨代健康洞察："爷爷有糖尿病和高血压家族史，您的相关指标应重点关注"

**FR-06 医生共享端口**
- 患者可授权医生访问完整健康档案（时间段选择授权）
- 医生端Web界面：快速浏览关键指标趋势，标注诊断和处置建议
- 随访记录：医生定期添加随访笔记，形成医患协作记录
- 国家健康平台对接：符合《健康档案基本架构与数据标准》，对接国家居民健康档案

### 5. 非功能性需求（NFR）

| 维度 | 指标 |
|------|------|
| 数据整合延迟 | 设备新数据<1分钟同步到平台 |
| 历史数据存储 | 无限量（老人全生命周期） |
| 医院数据对接成功率 | 覆盖50%以上三甲医院（通过国家健康信息平台） |
| 检验报告OCR识别率 | 常见检验报告识别率>95% |
| 隐私安全 | 医疗数据等级，零知识数据访问日志，用户可随时撤销授权 |
| 多端同步 | iOS/Android APP + Web端，<3秒全端同步 |

### 6. 约束条件与合规要求

- 健康数据平台须按《网络安全法》和《数据安全法》建设（数据本地化）
- 医疗健康信息按国家《电子健康档案基本架构》标准存储
- AI健康洞察：明确标注为"参考建议"，不替代专业医疗诊断
- 医院数据接口：须与各地卫健委协议合规对接，不违反患者知情同意规定

---

## B. 详细设计方案

### 1. 系统架构

```
[数据采集层]
本系列设备P13–P28 → 设备API
医院HIS/LIS → 国家健康平台API
外部健康APP → HealthKit/Google Fit标准API
手动录入/OCR → 前端采集服务
          ↓
[数据整合层]
ETL管道（数据清洗/归一化/单位统一）
数据湖（时序数据库InfluxDB + 关系数据库PostgreSQL）
          ↓
[智能分析层]
健康趋势分析引擎（Python ML服务）
AI洞察引擎（LLM + 结构化数据RAG）
风险评估模型（心血管/肾病/跌倒）
          ↓
[应用层]
老人APP（简化版，健康周报+关键预警）
家属APP（全功能，多老人管理）
医生Web端（专业视图，完整历史数据）
```

### 2. 技术设计方案

**2.1 数据整合管道**
```python
class HealthDataPipeline:
    def ingest(self, source: str, raw_data: dict) -> HealthRecord:
        # 数据源适配器（各设备/医院API格式统一转换）
        adapter = AdapterFactory.get(source)
        normalized = adapter.transform(raw_data)
        
        # 单位标准化（mmHg/kPa/cmHg统一为mmHg）
        standardized = UnitStandardizer.convert(normalized)
        
        # SNOMED CT术语映射
        coded = SNOMEDMapper.encode(standardized)
        
        # 存储（时序数据库）
        self.db.insert(coded)
        
        # 触发实时分析
        self.analyzer.on_new_data(coded)
```

**2.2 检验报告OCR解析**
```python
def parse_lab_report(image_or_pdf):
    # OCR提取全文（百度OCR / 腾讯OCR）
    raw_text = ocr_engine.extract(image_or_pdf)
    
    # 结构化提取（LLM辅助）
    prompt = f"""从以下检验报告文本中提取检验项目、结果值、单位和参考范围：
    {raw_text}
    输出JSON格式：[{{"item": "血糖", "value": 6.2, "unit": "mmol/L", "ref_range": "3.9-6.1", "abnormal": true}}]"""
    
    structured = llm.extract_structured(prompt)
    return map_to_standard_codes(structured)
```

**2.3 AI健康洞察（RAG架构）**
```
用户健康档案 → 向量化存储（Chroma/Weaviate）
    +
医学知识库（指南/文献摘要）
    ↓
用户问题/定期分析触发
    ↓
检索相关健康记录和知识片段
    ↓
LLM生成个性化洞察（有引用依据，可追溯）
```

**2.4 风险评分模型**

Framingham心血管风险计算：
- 输入：年龄、性别、血压、总胆固醇、HDL、吸烟史、糖尿病史
- 数据来源：平台历史数据自动填充（无需手动输入）
- 输出：10年心血管事件概率（%）

自定义跌倒风险评分：
- 输入：步态数据（P07）、平衡数据（P09）、用药情况（P16安眠药/降压药）、骨密度（P18）
- 逻辑回归模型（基于历史跌倒事件数据训练）
- 输出：跌倒风险等级（低/中/高）

### 3. 用户交互设计

**老人端APP（极简）**
- 主页：今日健康摘要（绿/黄/红状态灯 + 1句话总结）
- 点进任意指标：展示最近30天趋势图（大字体，简洁颜色）
- 每周健康报告：语音播报（"本周您的血压控制良好，睡眠质量比上周有所改善"）

**家属端APP**
- 多老人切换：家庭成员列表，每人一行状态摘要
- 异常推送：某指标进入异常区间，立即推送+建议行动
- 就医前：生成"带给医生的摘要"，一键发送到老人手机

**医生Web端**
- 患者档案：时间轴视图，所有指标叠加显示
- 快速筛选：选择时间段、指标类型
- 添加随访笔记（语音转文字，自动结构化）

### 4. 商业化路径与技术风险

**商业化路径**
- **免费层**：本系列设备数据自动同步，基础健康档案（驱动硬件销售）
- **订阅**：129元/年（AI洞察分析+跨设备关联+就医摘要生成）
- **家庭版**：199元/年（最多6位家庭成员，家属全功能版）
- **医生版**：49元/患者/月（含完整随访工具，对接医院采购）
- **数据合规变现**：匿名化健康趋势数据用于流行病学研究（须用户授权）

**技术风险评估**

| 风险 | 等级 | 应对措施 |
|------|------|----------|
| 医院HIS数据接口不开放 | 高 | 优先接入国家健康平台（覆盖越来越多），同时支持PDF检验报告OCR上传 |
| 跨设备数据标准不统一 | 高 | 与主流设备建立合作协议，提供标准SDK，统一数据格式 |
| AI洞察误导老人自我诊断 | 中 | 所有AI建议标注置信度和免责声明，并提供"询问医生"一键功能 |
| 数据安全（医疗数据价值高，攻击目标） | 高 | 零信任架构，数据分级加密，渗透测试每季度一次，漏洞赏金计划 |
