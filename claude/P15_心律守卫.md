# P15 心律守卫——房颤早期预警智能心电背心

---

## A. 需求分析文档

### 1. 产品概述与定位

**心律守卫**是一款嵌入12导联干式电极的智能心电监测背心，可在日常穿着中持续采集医疗级心电图，通过端侧AI模型实时检测心房颤动（房颤）、室性早搏、ST段异常等心律失常事件，实现"穿上即监测，异常即预警"。房颤是老年人中最常见的心律失常，也是脑卒中的最主要可预防病因，早期发现房颤可使脑卒中风险降低68%。

**蓝海点**：Holter动态心电图只能在医院佩戴24–48小时，居家长程心电监测几乎空白；智能心电衬衫（如Hexoskin）主要面向运动员，无医疗级预警功能，老年版市场空白。

### 2. 目标用户画像

| 维度 | 描述 |
|------|------|
| 核心用户 | 65–80岁，有心悸、胸闷症状但Holter未检出的老年人 |
| 次要用户 | 有脑卒中家族史、高血压、糖尿病（房颤高危因素）老年人 |
| 使用场景 | 日常穿着（家居活动、室内外散步），每次≥8小时 |
| 医疗背景 | 心内科医生推荐进行长程心电监测 |
| 监测时长需求 | 阵发性房颤可能只持续数分钟，需7–30天长程监测才能捕获 |

### 3. 市场痛点与机会

- 阵发性房颤的漏诊率高达70%（因传统Holter监测时间短）
- 房颤→脑栓塞每年导致约20万中国人死亡
- Apple Watch可检测房颤，但ECG精度有限，单导联，且不适合老年人长期佩戴
- 医疗级多导联长程心电监测设备（iRhythm Zio贴片）：价格昂贵，国内几乎无同类产品
- 背心形态：不需要粘附皮肤，无皮肤刺激风险，老年人接受度高

### 4. 功能性需求（FR）

**FR-01 持续12导联心电采集**
- 背心内置18个干式Ag/AgCl电极（覆盖标准12导联位置）
- 采样率：500Hz（诊断级ECG标准要求）
- 12导联信号同步采集，CMRR>80dB
- 运动伪迹抑制：弹性面料保持电极紧贴皮肤，信号连续性>95%

**FR-02 房颤实时检测（端侧AI）**
- 背心主控模块中运行轻量级深度学习模型（CNN+LSTM）
- 检测目标：
  - 心房颤动（AF）：P波消失 + RR间期不规则
  - 室性早搏（PVC）：宽大畸形QRS波
  - ST段抬高/压低（心肌缺血预警）
  - 二度/三度房室传导阻滞
- 房颤检测灵敏度目标：≥97%，特异度≥95%（PhysioNet数据集验证）

**FR-03 事件记录与存储**
- 本地存储：完整ECG数据7天（SD卡，32GB）
- 事件标记：检测到心律失常时，自动标记时间戳并保存前后60秒ECG片段
- 主动标记：用户感到心悸时按下背心肩部按键，标记症状时间点

**FR-04 告警与推送**
- 持续房颤>30分钟：背心主控振动+语音告警，手机推送家属
- 严重事件（室颤征兆、ST抬高）：立即启动紧急呼叫
- 每日心律摘要：主要心律类型占比、异常事件数、建议

**FR-05 医生远程判读**
- ECG数据上传云端，心内科医生可远程查看波形
- AI预标注：将疑似异常段高亮，减少医生判读时间
- 报告格式：符合《动态心电图报告规范》（中华心律失常杂志标准）

**FR-06 穿戴管理**
- 背心可机洗（主控模块防水插拔分离，电极片可洗）
- 主控模块磁吸充电，续航≥72小时
- 尺寸：M/L/XL三码（适合中国老年人体型）

### 5. 非功能性需求（NFR）

| 维度 | 指标 |
|------|------|
| ECG信噪比 | SNR≥30dB（安静状态），≥20dB（慢速步行） |
| 房颤检测精度 | 灵敏度≥97%，特异度≥95%（PhysioNet AF验证集） |
| 主控模块防水 | IPX7（可分离，分离后背心可机洗） |
| 主控续航 | ≥72小时连续采集 |
| 面料舒适性 | 导电弹性纤维，排汗透气，长时间穿着无皮肤刺激 |
| 重量 | 背心+主控<350g |

### 6. 约束条件与合规要求

- ECG监测设备须作为**II类医疗器械**申报
- 告警功能须有医生设置授权机制（避免频繁误报导致老人恐慌）
- 植入起搏器用户：评估电磁干扰风险，需标注注意事项
- 电气安全：IEC 60601-1，Type BF（体表浮地，直接心前区应用）
- 云端ECG数据：按医疗数据最高等级加密存储，医生查看须授权

---

## B. 详细设计方案

### 1. 系统架构

```
[心律守卫背心]
     ├── 18个干式电极（覆盖12导联）
     ├── 主控模块（磁吸式，可拆卸）
     │     ├── ADS1298（8通道ECG ADC）×2 = 16通道
     │     ├── 端侧AI加速器（MCU+DSP）
     │     ├── BLE 5.0 + 4G LTE SIM
     │     ├── 32GB MicroSD
     │     └── 2,000mAh锂电
     └── 症状标记按键（肩部）
          │ BLE / 4G
          ▼
[手机APP + 云端]
     ├── 实时心律显示
     ├── 异常事件告警
     ├── 医生远程判读平台
     └── 月度心律健康报告
```

### 2. 硬件设计方案

**2.1 电极系统**
- 导电纤维：银涂层弹性纤维（电阻<5Ω/cm），编织入背心内衬
- 电极垫：直径20mm圆形电极区，导电硅胶缓冲（确保皮肤接触）
- 导联覆盖：肢体导联（I/II/III/aVR/aVL/aVF）+ 6个胸导联（V1–V6）+ 2个备用

**2.2 主控模块**
- ECG ADC：TI ADS1298（8通道，24bit，500SPS，CMRR>100dB）×2
- AI推理：STM32H7+CMSIS-NN（运行INT8量化CNN模型，实时推理延迟<100ms）
- 通信：BLE 5.0（日常同步）+ 4G LTE Cat.1（紧急事件实时上传）
- 存储：32GB MicroSD，循环覆盖，保留最近7天完整ECG
- 磁吸接口：12Pin磁吸连接器（信号+电源），防脱落设计

**2.3 面料结构**
- 外层：导湿涤纶运动面料
- 内层：含银导电弹性纤维（39%银纤维+61%弹力纤维）
- 弹性：四向拉伸，确保电极在运动中保持皮肤接触

### 3. 核心算法设计

**3.1 房颤检测模型（端侧CNN+LSTM）**
```
输入：30秒单导联ECG片段（II导联，15,000采样点）
    ↓
预处理：带通0.5–40Hz + 工频陷波 + 等电线归零
    ↓
特征提取层（CNN）：提取QRS复波形态特征
    ↓
序列建模层（LSTM）：捕捉RR间期节律特征
    ↓
输出：房颤概率（0–1），阈值0.5判定为房颤
    
模型大小：<500KB（INT8量化）
推理时间：<80ms（STM32H7@480MHz）
```

**3.2 R波检测（Pan-Tompkins算法改进版）**
```python
def detect_r_peaks(ecg, fs=500):
    # 带通滤波（5-15Hz，QRS能量集中频段）
    filtered = bandpass_filter(ecg, 5, 15, fs)
    # 微分 + 平方（增强QRS尖峰）
    diff_sq = np.diff(filtered)**2
    # 移动均值（积分）
    integrated = moving_average(diff_sq, window=int(0.15*fs))
    # 自适应阈值检测峰值
    peaks = adaptive_threshold_peak_detect(integrated)
    return peaks
```

**3.3 异常事件分级**
- Level 1（提示）：偶发早搏（<6次/分钟），APP推送每日摘要
- Level 2（警告）：阵发性房颤（>30秒），振动告警+家属推送
- Level 3（紧急）：室性心动过速、ST抬高、高度房室传导阻滞，立即启动紧急呼叫

### 4. 用户交互设计

**穿戴与启动**
```
穿上背心（内电极面朝内）→ 将主控模块卡入磁吸接口
→ 手机APP自动连接，显示12导联ECG波形预览
→ 信号质量检测（绿色=良好，黄色=接触不佳，提示调整）
→ "开始今日心律监测"→ 后台静默持续采集
```

**日常使用**
- 感到心悸时：按背心肩部按键 → 标记症状 → 自动保存片段
- 每晚推送：今日心律摘要（正常窦律时长/早搏次数/有无异常事件）
- 洗背心时：主控模块插拔一键分离，放入密封袋保存

### 5. 商业化路径与技术风险

**商业化路径**
- **硬件**：背心+主控模块套装2,600元
- **服务**：199元/月（云端数据存储+医生远程判读，含月报）
- **B端**：医院心内科长程Holter替代方案，科室采购+患者租用
- **保险合作**：长期心脏健康险配套监测设备

**技术风险评估**

| 风险 | 等级 | 应对措施 |
|------|------|----------|
| 运动伪迹导致误报 | 高 | 运动检测（加速度计），高运动期降低AI告警灵敏度，仅保留严重事件告警 |
| 老人皮肤干燥导致电极接触差 | 高 | 导电凝胶辅助垫（随附），穿戴前用湿毛巾擦拭皮肤 |
| 面料洗涤后导电性下降 | 中 | 采用银纤维（耐洗涤>100次），提供导电性测试卡（月测一次） |
| 医生判读资源不足 | 中 | AI预筛选，仅推送AI判定异常>70%的片段，减少医生工作量 |
