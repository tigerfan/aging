# P26 睡眠护航仪——非接触式睡眠呼吸障碍监测智能枕

---

## A. 需求分析文档

### 1. 产品概述与定位

**睡眠护航仪**是一款嵌入式多传感器智能枕，通过压电薄膜传感器、振动传感器和高灵敏度麦克风，在用户睡眠期间无感监测呼吸规律、鼾声、心跳和体动，识别睡眠呼吸暂停（OSA）事件和周期性肢体运动障碍，同时追踪睡眠分期（浅睡/深睡/REM），提供医疗参考级别的居家睡眠质量评估报告。配合体位干预功能（轻微振动提示改变体位），非侵入式地改善睡眠质量。

**蓝海点**：老年人OSA患病率高达30–50%，但就诊率极低；医院多导睡眠监测（PSG）费用昂贵且需住院；现有家用睡眠监测（环戒/耳机）对重度OSA漏诊率高；枕头形态无需佩戴，老年人接受度最高。

### 2. 目标用户画像

| 维度 | 描述 |
|------|------|
| 核心用户 | 60–80岁，有打鼾、夜间憋醒、晨起头痛、日间嗜睡症状的老年人 |
| 次要用户 | 高血压/心血管病老年患者（OSA是心血管事件的独立风险因素） |
| 同床人 | 配偶反映鼾声影响睡眠，希望有客观数据推动就医 |
| 医疗背景 | 睡眠科/耳鼻喉科/心内科医生，PSG前筛查工具需求 |

### 3. 市场痛点与机会

- 中国OSA患者约7,000万，AHI≥15（中重度）约3,000万，但就诊率<5%
- 医院PSG：需住院一晚，费用1,500–3,000元，等待时间长
- 家用便携式PSG（WatchPAT等）：价格高，需戴口鼻气流传感器（不舒适）
- 智能枕（Nitetronic等）：已验证可行性，但功能主要局限于鼾声减少，无深度评估
- CPAP（持续气道正压通气）是OSA的有效治疗，但患者依从性差，缺乏居家监测工具指导治疗调整

### 4. 功能性需求（FR）

**FR-01 睡眠呼吸暂停检测**
- 压电薄膜传感器阵列（枕面8×8=64点）：检测呼吸相关微振动和体位
- 麦克风：鼾声录制（非持续录音，仅事件触发），鼾声频谱分析（识别阻塞性OSA特征鼾声）
- AHI估算（呼吸暂停低通气指数）：检测呼吸暂停>10秒事件，计算每小时发生次数
- 血氧下降：配合可穿戴戒指（P13皮肤光谱戒）或指夹SpO2，检测氧合下降≥3%

**FR-02 睡眠分期分析**
- 多特征融合：心跳节律（HRV）+ 呼吸节律 + 体动频率 + 时间
- 睡眠分期：觉醒/浅睡（N1+N2）/深睡（N3）/REM四分法
- 睡眠效率、入睡潜伏期、总睡眠时间自动统计
- 与PSG比对：睡眠分期准确率目标≥78%（文献报道枕基方法水平）

**FR-03 鼾声分析与干预**
- 鼾声录制（每次鼾声事件仅录制5–10秒片段）
- 鼾声强度分贝记录，峰值时间轴
- 体位提示：检测到鼾声/呼吸暂停时，枕头侧边轻微振动（提示改变体位）
- 仰卧→侧卧转换：研究表明侧卧可使AHI降低50%以上

**FR-04 睡眠报告**
- 每日晨间推送：睡眠评分（0–100）、深睡比例、AHI估算值、最长呼吸暂停时长
- 周趋势图：睡眠质量趋势、AHI变化、鼾声分贝趋势
- 专业报告：AHI+氧减指数+体位图+睡眠分期图，可发送给睡眠科医生作为PSG前参考
- 就医建议：AHI估算>15时，系统推荐就医进行PSG确诊

**FR-05 CPAP治疗辅助**
- 已诊断OSA患者：记录每晚CPAP使用时长、面罩漏气情况（通过麦克风检测漏气声）
- CPAP效果评估：使用CPAP后AHI变化趋势
- 依从性提醒：未使用CPAP的夜晚，APP温和提醒

### 5. 非功能性需求（NFR）

| 维度 | 指标 |
|------|------|
| AHI估算误差 | 与PSG对比：±5次/小时（中重度OSA筛查级别） |
| 睡眠分期准确率 | ≥75%（与PSG比对，文献水平） |
| 噪声 | 体位干预振动<30dB（不扰醒老人） |
| 枕套 | 抗菌慢回弹记忆棉，可拆洗，枕芯传感层可酒精擦拭 |
| 续航 | 7天（每晚8小时，充电一次） |
| 连接 | WiFi（自动同步）+ BLE（与APP实时连接） |

### 6. 约束条件与合规要求

- 产品定位：OSA筛查参考工具，非诊断设备，建议PSG确诊
- 鼾声录音：触发式录制（不持续录音），数据本地处理后仅上传统计结果
- 向家属推送：仅推送统计数据（AHI估算、睡眠评分），不推送鼾声录音
- SpO2监测联动：须使用已通过NMPA认证的血氧设备

---

## B. 详细设计方案

### 1. 系统架构

```
[睡眠护航仪（智能枕）]
     ├── 64点压电传感阵列（枕面，检测呼吸体动）
     ├── 低噪声MEMS麦克风（鼾声采集）
     ├── 振动电机×2（体位干预，枕头侧边）
     ├── 边缘AI处理板（Raspberry Pi Zero 2W）
     └── WiFi + BLE
          │ WiFi
          ▼
[手机APP]
     ├── 睡眠报告（分期+AHI+鼾声）
     ├── CPAP辅助管理
     └── 医生报告导出
          ▼
[云端服务]
     ├── 睡眠趋势数据库
     ├── PSG对比验证服务
     └── 睡眠科医生远程判读
```

### 2. 硬件设计方案

**2.1 压电传感阵列**
- 传感元件：PVDF压电薄膜（8×8=64个，间距约20mm），铺设于枕面内层
- 信号路由：行列多路复用（64路→16通道ADC），100Hz采样率
- 检测目标：呼吸振动（0.1–0.5Hz）、心跳振动（0.8–2.5Hz）、体动（宽频）

**2.2 麦克风**
- 型号：ICS-43434（MEMS，低噪，动态范围60dB）
- 位置：枕侧中央，距口鼻约20cm
- 鼾声触发：超过45dB持续>1秒触发录制，最长录5秒，随即停止

**2.3 体位干预振动**
- LRA线性马达×2（枕左侧/右侧各一个），振感集中、安静
- 干预模式：2Hz低频轻柔振动，持续5秒（类似轻拍肩膀的感觉）

**2.4 枕体结构**
- 外形：标准枕头（60cm×40cm×12cm）
- 枕芯层次：传感层（内层，PET无纺布包裹压电阵列）+ 慢回弹记忆棉（外层）
- 枕套：100%天丝棉（凉感，抗菌），可机洗，60°C热洗消毒

### 3. 核心算法设计

**3.1 呼吸与心跳提取（压电传感）**
```python
def extract_vitals(piezo_signal, fs=100):
    # 带通滤波分离呼吸（0.1-0.5Hz）和心跳（0.8-2.5Hz）
    breath = bandpass(piezo_signal, 0.1, 0.5, fs)
    heart = bandpass(piezo_signal, 0.8, 2.5, fs)
    
    # 呼吸率：峰值检测计数
    breath_peaks, _ = find_peaks(breath, distance=fs*1.5)  # 最小间隔1.5秒
    breath_rate = len(breath_peaks) / (len(piezo_signal)/fs) * 60
    
    # 心率：自相关函数法（更稳健）
    heart_autocorr = np.correlate(heart, heart, mode='full')
    heart_period = find_first_peak(heart_autocorr[len(heart):]) / fs
    heart_rate = 60 / heart_period if heart_period > 0 else 0
    
    return breath_rate, heart_rate
```

**3.2 呼吸暂停检测**
```python
def detect_apnea(breath_signal, fs=100):
    envelope = np.abs(hilbert(breath_signal))
    smoothed = moving_average(envelope, window=int(5*fs))  # 5秒平滑
    
    # 基线振幅（前1小时均值）
    baseline = np.mean(smoothed[:3600*fs])
    threshold = baseline * 0.1  # 振幅降至基线10%以下
    
    # 检测低振幅持续段（呼吸暂停）
    apnea_events = []
    low_amp = smoothed < threshold
    for start, end in find_continuous_regions(low_amp):
        duration = (end - start) / fs
        if duration >= 10:  # 呼吸暂停≥10秒
            apnea_events.append({'start': start/fs, 'duration': duration})
    
    ahi = len(apnea_events) / (total_sleep_time/60)  # 次/小时
    return apnea_events, ahi
```

**3.3 睡眠分期（多特征融合）**
```
每30秒一个epoch，提取特征：
- 呼吸率均值/变异性
- HRV（RMSSD，低/高频功率比）
- 体动强度（压电信号RMS）
- 时间（距入睡的分钟数，REM通常在后半夜多）

XGBoost分类器（4类：Wake/N1+N2/N3/REM）
训练数据：自建数据集（枕基信号+PSG同步标注，n=500例）
```

### 4. 用户交互设计

**睡眠流程（无操作）**
```
老人上床平躺 → 枕头自动检测到头部压力 → 进入睡眠监测模式
→ 全程静默监测（无任何提示音）
→ 检测到仰卧鼾声：枕侧轻微振动（5秒，提示换姿势）
→ 早晨起床离开枕头 → 自动结束记录
→ APP推送晨间睡眠报告
```

**晨间报告卡片（APP）**
- 大字版睡眠评分（彩色圆形进度图，简单直观）
- 关键指标：睡眠时长、深睡占比、AHI估算值、鼾声分钟数
- 3行建议文字（短小精悍）

### 5. 商业化路径与技术风险

**商业化路径**
- **硬件**：1,380元（含智能枕主体+配套APP）
- **服务**：99元/年（云端分析+专业睡眠报告+医生远程判读服务）
- **B端**：酒店健康客房配置（高星级酒店老年友好房型），养老院睡眠健康管理
- **联动**：与CPAP厂商（瑞思迈等）合作，作为CPAP依从性监测工具

**技术风险评估**

| 风险 | 等级 | 应对措施 |
|------|------|----------|
| 老人睡姿多变（压电信号不稳定） | 高 | 8×8阵列动态选取最优传感点，对抗体位变化 |
| AHI估算误差大（无口鼻气流传感） | 高 | 明确定位为"筛查工具"，AHI>15建议PSG确诊，训练大量真实数据提升精度 |
| 体位干预振动扰醒老人 | 中 | 振动强度在浅睡期才触发（深睡/REM期关闭干预），振动极轻柔 |
| 鼾声麦克风采集到环境噪声（配偶鼾声） | 中 | 指向性麦克风+位置优化（仅接收枕面上方声音），OSA特征频谱过滤 |
