# P11 行走伴侣——社交型智能助行机器人

---

## A. 需求分析文档

### 1. 产品概述与定位

**行走伴侣**是一款兼顾移动辅助与情感陪伴的智能助行机器人，外形类似可跟随的小型轮式机器人（非外骨骼），通过SLAM自主导航跟随老人步行，提供物理支撑（扶手）和语音互动。其核心差异在于：集成LLM对话能力，能够主动发起自然对话、引导老人讲故事、分享健康小知识，将枯燥的步行锻炼变成愉快的"社交散步"，同时持续进行步态健康监测。

**蓝海点**：现有助行器（walker/轮椅）仅解决移动辅助，情感孤独问题无人解决；智能跟随机器人（如Amazon Astro）不具备医疗辅助功能，两者结合形成独特蓝海。

### 2. 目标用户画像

| 维度 | 描述 |
|------|------|
| 核心用户 | 70–85岁，步行稳定性下降、独居、有孤独感的老年人 |
| 次要用户 | 帕金森早期患者，需要步态辅助和认知刺激 |
| 使用场景 | 室内/小区走廊/公园步道，每日30–60分钟步行 |
| 家属动机 | 担心老人独居安全，希望有"替代陪伴"工具 |
| 感情需求 | 老人需要被倾听、被关注，不只是功能性辅助 |

### 3. 市场痛点与机会

- 空巢老人超1亿，情感陪伴缺失是最严重的老龄化社会问题之一
- 传统助行器（步行架）功能单一，无互动，老人使用依从性低
- 家用服务机器人（扫地机器人量级）价格下降，机器人底盘技术成熟
- LLM技术使"自然对话"成为可能，不再是预设问答
- 步行锻炼对老年健康的重要性已有大量研究支持，但缺乏坚持动力

### 4. 功能性需求（FR）

**FR-01 跟随移动辅助**
- SLAM自主导航，实时跟随老人移动（跟随距离0.5–1m可调）
- 多障碍物避障（行人、桌椅、门槛）
- 速度范围：0.2–1.5m/s，跟上老年人正常步速
- 可收起扶手：升降式扶手（高度调节70–95cm），需要时扶持，不需要时收回

**FR-02 语音社交对话（LLM驱动）**
- 配备麦克风阵列和扬声器，实时语音对话
- 对话能力：
  - 主动发起话题（天气、新闻、节气习俗、老人历史兴趣）
  - 引导老人讲家庭故事（口述历史引导词）
  - 健康小知识分享（每日一条，非说教方式）
  - 情绪安慰（检测到老人情绪低落时给予鼓励）
- 支持20种方言理解，普通话/粤语/闽南语流畅回复

**FR-03 步态健康监测**
- 机器人载摄像头（下视）追踪老人脚步节律
- 测量：步频、步幅估算、行走速度、步态对称性
- 5米步行测试自动化（步行速度是老年综合征关键指标）
- 每日步行数据存档，推送家属APP

**FR-04 安全监护**
- 跌倒检测：摄像头+IMU联合检测老人快速下落
- 跌倒后：机器人停止移动，启动紧急呼叫（联系家属/急救）
- GPS室外定位（精度<5m），实时位置推送家属
- 电量预警：电量<20%时主动提醒老人返回充电（机器人语音引导）

**FR-05 健康提醒与任务**
- 步行目标：每日设定步行时间/步数目标，进度实时播报（"今天已走20分钟，还有10分钟就完成目标！"）
- 用药提醒：到时间语音提醒，并引导老人去拿药
- 饮水提醒：每45分钟提醒喝水（老年人口渴感减退）

**FR-06 充电与维护**
- 自主返回充电桩（低电量自动导航回充）
- 充电时间：2小时充满，支持续航8小时日常使用
- 远程诊断：异常时推送家属和厂商，远程修复或派人上门

### 5. 非功能性需求（NFR）

| 维度 | 指标 |
|------|------|
| 对话自然度 | LLM响应延迟<1.5秒（含语音识别+推理+TTS） |
| 跟随精度 | 与老人距离保持误差±15cm |
| 噪声 | 运动噪声<45dBA（不妨碍对话） |
| 尺寸 | 底盘宽<50cm（通过标准门宽80cm），高约100cm |
| 障碍物反应 | 障碍物停止距离<20cm |
| 室内地面适应 | 适应瓷砖、木地板、地毯、门槛（<2cm）过渡 |
| 防护 | IP32（轻微防水，应对雨天室外短暂使用） |

### 6. 约束条件与合规要求

- 机器人底盘安全：符合ISO 13482（个人护理机器人安全标准）
- 摄像头数据：本地处理，步态分析完成后删除原始视频
- LLM对话内容：不涉及医疗诊断建议，健康信息来源可溯源
- 户外使用限制：仅适用于平整路面，不适用于楼梯、坡度>8°路面
- 紧急呼叫：须在APP中预设至少2个紧急联系人，SIM卡独立通话能力

---

## B. 详细设计方案

### 1. 系统架构

```
[行走伴侣机器人]
     ├── 激光雷达（2D，SLAM导航）
     ├── 深度相机（跟随+跌倒检测）
     ├── 4麦克风阵列（语音拾音）
     ├── 双扬声器（对话+报警）
     ├── 升降式扶手（电动）
     ├── 差分驱动底盘（双轮+辅助轮）
     ├── 主控计算板（边缘AI推理）
     └── 4G/5G SIM + WiFi + BLE
          │ 4G/WiFi
          ▼
[云端服务]
     ├── LLM对话引擎（流式推理）
     ├── 步态数据库+趋势分析
     ├── 地图服务（室内地图构建）
     └── 远程监控后台
          ▼
[家属APP]
```

### 2. 硬件设计方案

**2.1 移动底盘**
- 驱动：差分驱动（两个100W无刷电机，独立控制）
- 轮径：φ160mm橡胶轮，前后各2个辅助万向轮（稳定性）
- 底盘高度：10cm（可过2cm门槛），宽48cm
- 最大速度：1.5m/s，承重：20kg（含扶手施加的力）

**2.2 传感器系统**
- 激光雷达：思岚A1（2D，12m范围，360°扫描，SLAM建图）
- 深度相机：Intel RealSense D435i（深度+RGB，用于人体跟随和跌倒检测）
- IMU：9轴IMU（底盘姿态+碰撞检测）
- 超声波：4组超声波测距（低矮障碍物补充检测）
- 下视摄像头：200万像素，追踪老人脚步（步态分析）

**2.3 计算系统**
- 主控：英伟达Jetson Orin NX（16GB，AI推理，SLAM，语音处理）
- 低层控制MCU：STM32F4（电机控制、传感器采集）
- 通信：4G LTE + WiFi 6 + BLE 5.0
- 电池：48V/20Ah锂电池组，续航8小时日常使用

**2.4 人机交互硬件**
- 麦克风：4麦克风环形阵列（波束成形，拾音距离3m）
- 扬声器：双5W全频，语音清晰度优先调音
- 显示：7英寸触控屏（胸部位置，显示表情动画，增强亲切感）
- 扶手：铝合金升降扶手，高度电动调节，握持部分橡胶包裹

### 3. 软件设计方案

**3.1 ROS 2导航栈**
```
├── SLAM模块（Cartographer，实时建图）
├── 路径规划（Nav2，动态避障）
├── 人体跟随模块（深度相机+骨架追踪，保持0.5-1m跟随距离）
├── 障碍物检测（多传感器融合：激光+深度+超声）
└── 运动控制器（速度平滑滤波，老年人友好的缓启动/缓停止）
```

**3.2 对话系统**
```
语音唤醒（离线关键词："小伴" / "行走伴侣"）
    ↓
ASR（讯飞星火离线+在线混合，方言支持）
    ↓
LLM对话引擎（云端流式推理，专为老年社交设计的System Prompt）
    │ 内置知识库：老年健康、节气文化、时事简报
    ↓
TTS合成（情感化语音，语速0.85×正常，音调温和）
    ↓
扬声器播放（同时显示表情动画）
```

**3.3 LLM对话策略设计**

System Prompt关键指令：
- 角色定位：老年人的健步陪伴者，话风温暖、耐心、不催促
- 主动话题触发：步行每5分钟自动发起新话题
- 禁止行为：不做医疗诊断、不讨论负面新闻、不催促步速
- 记忆功能：记住老人的兴趣爱好（从历史对话摘要），下次主动提及

### 4. 核心算法设计

**4.1 人体跟随算法**
```python
def follow_person(depth_frame, target_skeleton):
    # 从深度图提取目标人体质心
    person_pos = extract_centroid(target_skeleton, depth_frame)
    
    # 计算跟随误差
    distance_error = target_distance - current_distance(person_pos)
    angle_error = target_angle - current_angle(person_pos)
    
    # PID控制（速度和转向）
    linear_vel = kp_d * distance_error + ki_d * integral_d
    angular_vel = kp_a * angle_error + ki_a * integral_a
    
    # 速度限制（老年人友好，加速度<0.3m/s²）
    return smooth_velocity(linear_vel, angular_vel, max_accel=0.3)
```

**4.2 跌倒检测（视觉+IMU）**
- 骨架关键点纵向位移速率 > 1m/s → 疑似跌倒
- 底盘IMU检测到撞击震动 → 补充确认
- 双重触发后启动：
  1. 机器人停止移动
  2. 语音询问："您还好吗？"（等待5秒）
  3. 无响应 → 自动拨打紧急联系人，并显示位置地图

**4.3 步态参数提取（下视摄像头）**
- 足迹检测：背景差分 + 轮廓提取，识别每步落点
- 步频：相邻同侧落点时间间隔的倒数
- 步幅：机器人跟随速度×步频推算（估算值）
- 步态对称性：左右步时差异系数

### 5. 用户交互设计

**5.1 开机与日常启动**
```
老人靠近机器人（红外感应）→ 机器人屏幕亮起：笑脸动画
"早上好！今天天气不错，要出去走走吗？" → 老人回应
→ 机器人展开扶手，跟随老人出发
```

**5.2 步行过程中的对话示例**
- 主动话题："您之前说您年轻时爱钓鱼，那个年代最难忘的钓鱼经历是什么？"
- 进度播报（每10分钟）："已经走了15分钟了，完成今天目标的一半！很棒！"
- 健康知识："顺便说一下，今天节气是惊蛰，老话说'惊蛰不开镰，还有二十天'，您老家有什么惊蛰的习俗？"

**5.3 家属APP**
- 实时位置：地图显示老人当前位置
- 今日报告：步行时长、步数、步态评分、对话摘要（最有趣的对话片段）
- 留言：家属录音，由机器人在合适时机播放

### 6. 商业化路径与技术风险

**商业化路径**
- **定价**：9,800元（含机器人本体）
- **订阅**：299元/月（LLM对话服务 + 步态分析报告 + 远程监控）
- **租赁模式**：699元/月（降低初始门槛，适合收入中等家庭）
- **渠道**：养老机构批量采购（含机构版管理平台）、高端社区
- **政府补贴**：积极申请民政部智慧养老项目补贴

**技术风险评估**

| 风险 | 等级 | 应对措施 |
|------|------|----------|
| 室内地面多样（地毯/瓷砖/木地板）导航失败 | 高 | 多传感器融合，地面材质自适应速度控制 |
| LLM响应延迟导致对话不自然 | 高 | 边缘+云端混合推理，常用回复本地缓存 |
| 老年人信任机器人程度低 | 中 | 7英寸屏幕情感表达，拟人化但非仿人形，降低恐怖谷效应 |
| 电池续航（8小时）重量大 | 中 | 优化底盘重量分配，低重心设计，总重≤18kg |
| 儿童/宠物干扰跟随目标 | 中 | 目标锁定（开机时绑定特定用户特征），异常切换检测 |
